<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: How to use fhpredict • fhpredict</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Tutorial: How to use fhpredict">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fhpredict</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Tutorial: How to use fhpredict</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KWB-R/fhpredict">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial: How to use fhpredict</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/fhpredict/blob/master/vignettes/tutorial.Rmd"><code>vignettes/tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<div id="install-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#install-the-package" class="anchor"></a>Install the package</h2>
<p>Install the package fhpredict from GitHub, using the package remotes. Install from the “dev” branch to get the latest version:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages(remotes)</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"kwb-r/fhpredict@dev"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="users" class="section level2">
<h2 class="hasAnchor">
<a href="#users" class="anchor"></a>Users</h2>
<p>In the data model of the app everything is assigned to a user identified by a unique identifier, the user id. To get an overview on available users and their associated ids, run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Get overview on available users in a data frame</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">users &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_users.html">api_get_users</a></span>()</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Print the data frame</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">users</a></code></pre></div>
</div>
<div id="bathing-spots" class="section level2">
<h2 class="hasAnchor">
<a href="#bathing-spots" class="anchor"></a>Bathing Spots</h2>
<div id="overview-on-available-bathing-spots" class="section level3">
<h3 class="hasAnchor">
<a href="#overview-on-available-bathing-spots" class="anchor"></a>Overview on available bathing spots</h3>
<p>Use the function <code><a href="../reference/api_get_bathingspot.html">api_get_bathingspot()</a></code> to get an overview on the bathing spots that are stored in the postgres database. You need to specify the user to whom the bathing spots are associated. See above for how to get a list of available user ids.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Get overview on the first "limit" bathingspots associated to user with id 3</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">spots &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">spots2 &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">check =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(spots, spots2)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">33</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">33</span>, <span class="dt">check =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co"># Number of bathing spots returned</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(spots)</a></code></pre></div>
<p>By default, only the first bathing spots are considered in the returned data frame. Set the argument <code>limit</code> to a high number so that you get a list of all available bathing spots:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Get overview on all bathing spots associated to user with id 3</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">all_spots &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">limit =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># Number of bathing spots returned</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(all_spots)</a></code></pre></div>
</div>
<div id="create-a-new-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-new-bathing-spot" class="anchor"></a>Create a new bathing spot</h3>
</div>
<div id="delete-a-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-a-bathing-spot" class="anchor"></a>Delete a bathing spot</h3>
</div>
<div id="fetching-data-related-to-one-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#fetching-data-related-to-one-bathing-spot" class="anchor"></a>Fetching data related to one bathing spot</h3>
<p>Use the overview as retrieved above to lookup the bathing spot id that you are interested in. Then, call <code><a href="../reference/api_get_bathingspot.html">api_get_bathingspot()</a></code> again, this time by setting the argument <code>spot_id</code> accordingly:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Lookup bathing spots of interest by name</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">all_bathing_spots[<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"Jungfernheide"</span>, all_bathing_spots<span class="op">$</span>name), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"name"</span>)]</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Lookup the bathing spot id and store it in a variable spot_id</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">spot_id &lt;-<span class="st"> </span><span class="dv">17</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># Load the data available for the corresponding bathing spot id</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">spot &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> spot_id)</a></code></pre></div>
<p>It is also possible to get a bathing spot without specifying a user id:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># It is also possible to get a bathing spot without specifying a user id</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">spot_no_user &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">spot_id =</span> spot_id)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Is this the same as what we get when a user is specified?</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(spot, spot_no_user)</a></code></pre></div>
</div>
<div id="accessing-the-properties-of-a-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-properties-of-a-bathing-spot" class="anchor"></a>Accessing the properties of a bathing spot</h3>
<p>The variable <code>spot</code> now contains a list of properties of the selected bathing spot. As the list contains a lot of <code>NULL</code> elements, we remove these elements before looking at the overall structure of the list:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Look at the overall structure of the list omitting any NULL element</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(kwb.utils<span class="op">::</span><span class="kw">excludeNULL</span>(spot), <span class="dv">1</span>)</a></code></pre></div>
<p>Use the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> operator to access the different properties of the bathing spot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">spot<span class="op">$</span>id</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">spot<span class="op">$</span>nameLong</a></code></pre></div>
<div id="polygon-defining-the-catchment-area" class="section level4">
<h4 class="hasAnchor">
<a href="#polygon-defining-the-catchment-area" class="anchor"></a>Polygon defining the “catchment area”</h4>
<p>We are especially interested in the coordinates of the polygon that defines the area over which to average the rain data that is assumed to influence the water quality of the bathing spot. This information is stored in the list element <code>area</code>. It can be transformed into a GeoJSON string using the function <code>toJSON()</code> from the jsonlite package. There is also a list element <code>area_coordinates</code> that contains the same coordinates in the form of a two column data frame.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Polygon coordinates as a GeoJSON string</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">jsonlite<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span>(spot<span class="op">$</span>area)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co"># Polygon coordinates as a data frame</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(spot<span class="op">$</span>area_coordinates)</a></code></pre></div>
</div>
<div id="water-quality-measurements" class="section level4">
<h4 class="hasAnchor">
<a href="#water-quality-measurements" class="anchor"></a>Water quality measurements</h4>
<p>The <code>spot</code> object contains the results of water quality measurements in its list element <code>measurements</code>. Use the (non-exported) function <code>flatten_recursive_list</code> to convert the corresponding recursive list into a data frame.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Provide the measurements related to the bathing spot</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">measurements &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw">flatten_recursive_list</span>(spot<span class="op">$</span>measurements)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># Have a look at the first measurements (after removing empty columns)</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(kwb.utils<span class="op">::</span><span class="kw">removeEmptyColumns</span>(measurements))</a></code></pre></div>
</div>
</div>
</div>
<div id="measurements" class="section level2">
<h2 class="hasAnchor">
<a href="#measurements" class="anchor"></a>Measurements</h2>
<p>Measurements of water quality (concentration of E.coli) are imported from CSV files into the database by the end user. Use the following code to check for which bathing spots measurements are available:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Set user ID</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">user_id &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Get information on bathing spots</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">spots &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> user_id, <span class="dt">limit =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co"># Prepare a named vector of bathing spot IDs to be looped through</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">spot_ids &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(<span class="dt">nm =</span> spots<span class="op">$</span>id)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co"># Loop through the bathing spots and get the measurements (if any)</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">measurements &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(spot_ids, <span class="cf">function</span>(spot_id) {</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">  fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(user_id, spot_id)<span class="op">$</span>measurements</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">})</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># Determine and print the IDs of spots with at least one measurement</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">n_measurements &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(measurements)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co"># Show the corresponding number n of measurements</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">  <span class="dt">spot_id =</span> <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(n_measurements)[n_measurements <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>], </a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  <span class="dt">n =</span> <span class="kw"><a href="https://rdrr.io/r/base/unname.html">unname</a></span>(n_measurements[n_measurements <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>])</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">)</a></code></pre></div>
</div>
<div id="models" class="section level2">
<h2 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h2>
<div id="overview-on-available-models" class="section level3">
<h3 class="hasAnchor">
<a href="#overview-on-available-models" class="anchor"></a>Overview on available models</h3>
<p>Use the function <code><a href="../reference/api_get_model.html">api_get_model()</a></code> to get an overview on the models that are stored in the postgres database. You need to pass the user id (here: 3) and the id of the bathing spot (here: 18) to the function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Read all models that are stored for one bathing spot of one user</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">model_info &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_model.html">api_get_model</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>The function returns a data frame with one row per available model:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Show meta information on the models</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">model_info</a></code></pre></div>
<p>Use this overview on available models to lookup the id of the model that you actually want to fetch from the database.</p>
</div>
<div id="fetching-a-model" class="section level3">
<h3 class="hasAnchor">
<a href="#fetching-a-model" class="anchor"></a>Fetching a model</h3>
<p>Use the model id to fetch a specific model from the database:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Load model with id 27 from the database</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">model &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_model.html">api_get_model</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">18</span>, <span class="dt">model_id =</span> <span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Show the (rstan) model</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(model)</a></code></pre></div>
</div>
<div id="saving-a-model" class="section level3">
<h3 class="hasAnchor">
<a href="#saving-a-model" class="anchor"></a>Saving a model</h3>
<p>For testing purposes we store a simple, small object instead of a STAN model. We use the <code>cars</code> dataset that is shipped with “base R”. Use the function <code><a href="../reference/api_add_model.html">api_add_model()</a></code> to add the “model” to the database:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Look at the head of the cars dataset</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(cars)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># Add the cars dataset to the database</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">model_id &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw"><a href="../reference/api_add_model.html">api_add_model</a></span>(</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  <span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">18</span>, <span class="dt">model =</span> cars, <span class="dt">comment =</span> <span class="st">"Cars in R"</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">)</a></code></pre></div>
<p>The function returns the id of the model that was given by the database. We stored the id in the variable <code>model_id</code>. To check if the model arrived in the database we read it back, again using <code><a href="../reference/api_get_model.html">api_get_model()</a></code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Read the "model" back</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">my_cars &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_model.html">api_get_model</a></span>(<span class="dv">3</span>, <span class="dv">18</span>, model_id)</a></code></pre></div>
<p>We convince ourselves that what we get is identical to what we stored:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Nothing should have changed!</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(cars, my_cars)</a></code></pre></div>
</div>
<div id="deleting-a-model" class="section level3">
<h3 class="hasAnchor">
<a href="#deleting-a-model" class="anchor"></a>Deleting a model</h3>
<p>Use the function <code><a href="../reference/api_delete_model.html">api_delete_model()</a></code> to remove a model from the database. Let’s delete the model that we just added. Its id is given in the variable <code>model_id</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Delete the model with the id given in "model_id"</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_delete_model.html">api_delete_model</a></span>(<span class="dv">3</span>, <span class="dv">18</span>, model_id)</a></code></pre></div>
</div>
</div>
<div id="purification-plants" class="section level2">
<h2 class="hasAnchor">
<a href="#purification-plants" class="anchor"></a>Purification Plants</h2>
<p>Use the following script to check if there are any purification plants defined. As there are many bathing spots, the script takes quite a long time and is not run here so that you do not see any outputs.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># Get meta information on all bathing spots</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">bathing_spots &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">limit =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co"># Number of bathing spots</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(bathing_spots)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co"># Access the "purificationPlants" endpoint for each bathing spot</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8">purification_plants &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(bathing_spots<span class="op">$</span>id, <span class="cf">function</span>(spot_id) {</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb20-10" data-line-number="10">  <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"spot id = "</span>, spot_id)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb20-12" data-line-number="12">  result &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw">safe_postgres_get</span>(<span class="dt">path =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">    <span class="st">"%s/purificationPlants"</span>, </a>
<a class="sourceLine" id="cb20-14" data-line-number="14">    fhpredict<span class="op">:::</span><span class="kw"><a href="../reference/path_bathingspot.html">path_bathingspot</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> spot_id)</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">  ))</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb20-17" data-line-number="17">  result<span class="op">$</span>data</a>
<a class="sourceLine" id="cb20-18" data-line-number="18">})</a>
<a class="sourceLine" id="cb20-19" data-line-number="19"></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co"># How many bathing spots have purification plants?</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(purification_plants) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
</div>
<div id="rains" class="section level2">
<h2 class="hasAnchor">
<a href="#rains" class="anchor"></a>Rains</h2>
<p>This chapter describes how to</p>
<ul>
<li>read binary rain data related to a given time interval from files on the Amazon File Server,</li>
<li>spatially select and aggregate rain data that are related to a given bathing spot,</li>
<li>store the rain data in the Postgres database.</li>
</ul>
<p>Define bathing spot and reference time:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">user_id &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">spot_id &lt;-<span class="st"> </span><span class="dv">17</span> <span class="co"># Jungfernheide</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">sampling_time &lt;-<span class="st"> "1050"</span></a></code></pre></div>
<p>There is a top-level function that can be used to perform all steps at once. For the single steps that are performed within this function, see below.</p>
<p>In the following we reduce the range of days for which to load rain data to three days. Omitting <code>date_range</code> or setting it to <code>NULL</code> will instead load rain data for the whole range of dates for which measurements are available.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># Function to be triggered by the user: Provide rain data for the bathing spot</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">control &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/provide_rain_data.html">provide_rain_data</a></span>(</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  <span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">17</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  <span class="co">#, date_range = as.Date(c("2008-07-01", "2008-07-03"))</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6"></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="cf">while</span> (control<span class="op">$</span>remaining) {</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">  control &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/provide_rain_data.html">provide_rain_data</a></span>(control)</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">}</a></code></pre></div>
<p>Check that the data arrived by reloading them from the database:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Reload rain data from the database</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">rain &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_rain.html">api_get_rain</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">17</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># Show the first records of the rain data</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rain)</a></code></pre></div>
</div>
<div id="rains-details" class="section level2">
<h2 class="hasAnchor">
<a href="#rains-details" class="anchor"></a>Rains: Details</h2>
<div id="read-rain-data-stored-for-a-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#read-rain-data-stored-for-a-bathing-spot" class="anchor"></a>Read rain data stored for a bathing spot</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">(rain &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_rain.html">api_get_rain</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">43</span>))</a></code></pre></div>
</div>
<div id="delete-all-rain-data-stored-for-a-bathing-spot" class="section level3">
<h3 class="hasAnchor">
<a href="#delete-all-rain-data-stored-for-a-bathing-spot" class="anchor"></a>Delete all rain data stored for a bathing spot</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>(fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_delete_rain.html">api_delete_rain</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">43</span>))</a></code></pre></div>
</div>
<div id="add-some-fake-rain-data" class="section level3">
<h3 class="hasAnchor">
<a href="#add-some-fake-rain-data" class="anchor"></a>Add some fake rain data</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">new_rain &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">  <span class="dt">datum =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"2019-10-10"</span>), <span class="dt">by =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n),</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  <span class="dt">rain =</span> <span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6"></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">fhpredict<span class="op">:::</span><span class="kw">is_valid_postgres_api_token</span>(fhpredict<span class="op">:::</span><span class="kw">read_token</span>())</a>
<a class="sourceLine" id="cb26-8" data-line-number="8"></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">fhpredict<span class="op">:::</span><span class="kw"><a href="../reference/api_delete_rain.html">api_delete_rain</a></span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_add_rain.html">api_add_rain</a></span>(<span class="dt">user_id =</span> <span class="dv">3</span>, <span class="dt">spot_id =</span> <span class="dv">43</span>, <span class="dt">rain =</span> new_rain)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">date_from &lt;-<span class="st"> "20080701"</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">date_to &lt;-<span class="st"> "20080703"</span></a></code></pre></div>
</div>
<div id="read-rain-data-from-binary-radolan-files" class="section level3">
<h3 class="hasAnchor">
<a href="#read-rain-data-from-binary-radolan-files" class="anchor"></a>Read rain data from binary Radolan files</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Get URLs to Radolan files to be downloaded and read</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">urls &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw"><a href="../reference/get_radolan_urls_bucket.html">get_radolan_urls_bucket</a></span>(</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  <span class="dt">from =</span> date_from, </a>
<a class="sourceLine" id="cb28-4" data-line-number="4">  <span class="dt">to =</span> date_to, </a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="dt">time =</span> sampling_time, </a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="dt">bathing_season_only =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8"></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co"># Read rain data for a certain time period</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">radolan_stack &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw">read_radolan_raster_stack</span>(urls)</a>
<a class="sourceLine" id="cb28-11" data-line-number="11"></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co"># Show the raster images</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(radolan_stack)</a></code></pre></div>
</div>
<div id="spacially-select-and-aggregate-rain-data" class="section level3">
<h3 class="hasAnchor">
<a href="#spacially-select-and-aggregate-rain-data" class="anchor"></a>Spacially select and aggregate rain data</h3>
<p>We want to use only the rain data that lie within a polygon around the bathing spot. This area is a piece of metadata that are stored in the Postgres database for each bathing spot. We first read all metadata about the bathing spot defined above and provide the area information.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># Get metadata about the current bathing spot</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">spot &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(<span class="dt">spot_id =</span> spot_id)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co"># Check the name of the bathing spot</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">spot<span class="op">$</span>nameLong</a>
<a class="sourceLine" id="cb29-6" data-line-number="6"></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="co"># Provide the polygon in the same structure as returned by</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="co"># select_relevant_rain_area(), a function used by Wolfgang to define a polygon</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="co"># using an R Shiny app</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10">area &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw">convert_area_structure</span>(<span class="dt">spot_area =</span> spot<span class="op">$</span>area)</a>
<a class="sourceLine" id="cb29-11" data-line-number="11"></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="co"># Show the structure of the area information (a recursive list)</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(area, <span class="dv">2</span>)</a></code></pre></div>
<p>In the next step we use the area information to cut the area regions from the rain data that so far comprises whole Germany:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Crop the polygons from each raster layer</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">cropped &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw">crop_area_from_radolan_stack</span>(area, radolan_stack)</a></code></pre></div>
<p>We check the result by plotting the areas. <strong>Important note</strong>: It seems that not the polygon is cut but the “extent”, i.e. the smallest possible rectangle that contains the polygon!</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(cropped)</a></code></pre></div>
<p>We now calculate the average rain in each raster layer and provide a simple data frame:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># Get the mean over all layers for each point on the raster</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2">aggregated &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/cellStats.html">cellStats</a></span>(cropped, <span class="dt">stat =</span> mean)</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="co"># The day information can be restored from the names of the layers</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">dates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(radolan_stack), <span class="dv">2</span>, <span class="dv">9</span>), <span class="dt">format =</span> <span class="st">"%Y%m%d"</span>)</a>
<a class="sourceLine" id="cb32-6" data-line-number="6"></a>
<a class="sourceLine" id="cb32-7" data-line-number="7">rain &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">  <span class="dt">datum =</span> dates,</a>
<a class="sourceLine" id="cb32-9" data-line-number="9">  <span class="dt">rain =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(aggregated) <span class="op">/</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10">)</a></code></pre></div>
<p>Let’s have a look at the created data frame:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">rain</a></code></pre></div>
</div>
<div id="store-the-rain-data-in-the-postgres-database" class="section level3">
<h3 class="hasAnchor">
<a href="#store-the-rain-data-in-the-postgres-database" class="anchor"></a>Store the rain data in the Postgres database</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># Add rain data frame to the database</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">rain_ids &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_add_rain.html">api_add_rain</a></span>(user_id, spot_id, rain)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co"># Read rain from database</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5">rain &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_rain.html">api_get_rain</a></span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb34-6" data-line-number="6"></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="co"># What should we do with duplicates?</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span>(kwb.utils<span class="op">::</span><span class="kw">selectColumns</span>(rain, <span class="st">"dateTime"</span>)))</a>
<a class="sourceLine" id="cb34-9" data-line-number="9"></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co"># Delete rain data with given rain record ids</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_delete_rain.html">api_delete_rain</a></span>(user_id, spot_id, rain_ids)</a>
<a class="sourceLine" id="cb34-12" data-line-number="12"></a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="co"># For simplicity reasons: delete all rain data before inserting new data</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">#fhpredict::api_delete_rain(user_id, spot_id)</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co"># </span><span class="al">TODO</span><span class="co">: Remove only the duplicates, keeping the most current values</span></a></code></pre></div>
</div>
</div>
<div id="discharge-data" class="section level2">
<h2 class="hasAnchor">
<a href="#discharge-data" class="anchor"></a>Discharge data</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># Get existing discharge data</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">discharge_db &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_discharge.html">api_get_discharge</a></span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co"># Show the first records</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(discharge_db)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co"># Provide discharge test data</span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8">discharge &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">  <span class="dt">dateTime =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="dt">tz =</span> <span class="st">"Europe/Berlin"</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">    <span class="st">"2019-09-09 16:02:00"</span>, <span class="st">"2019-09-09 16:03:00"</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11">  )),</a>
<a class="sourceLine" id="cb35-12" data-line-number="12">  <span class="dt">discharge =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>, <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb35-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb35-14" data-line-number="14"></a>
<a class="sourceLine" id="cb35-15" data-line-number="15"><span class="co"># Add discharge test data to database</span></a>
<a class="sourceLine" id="cb35-16" data-line-number="16">ids &lt;-<span class="st"> </span>fhpredict<span class="op">:::</span><span class="kw">api_add_discharge</span>(user_id, spot_id, discharge)</a>
<a class="sourceLine" id="cb35-17" data-line-number="17"></a>
<a class="sourceLine" id="cb35-18" data-line-number="18"><span class="co"># Delete the records that have just been added. Omitting the IDs will remove</span></a>
<a class="sourceLine" id="cb35-19" data-line-number="19"><span class="co"># all discharge data related to the bathing spot</span></a>
<a class="sourceLine" id="cb35-20" data-line-number="20">fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_delete_discharge.html">api_delete_discharge</a></span>(user_id, spot_id, <span class="dt">ids =</span> ids)</a></code></pre></div>
</div>
<div id="irradiances-and-generic-inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#irradiances-and-generic-inputs" class="anchor"></a>Irradiances and Generic Inputs</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># Define user and bathing spot -------------------------------------------------</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2">user_id &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3">spot_id &lt;-<span class="st"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="co"># Define artificial time series ------------------------------------------------</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7">timeseries &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">  <span class="dt">date =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"2018-07-12"</span>), <span class="dt">by =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n), </a>
<a class="sourceLine" id="cb36-9" data-line-number="9">  <span class="dt">dateTime =</span> <span class="st">"12:13:14"</span>,</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">  <span class="dt">value =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb36-12" data-line-number="12"></a>
<a class="sourceLine" id="cb36-13" data-line-number="13"><span class="co"># Get overview on generic inputs -----------------------------------------------</span></a>
<a class="sourceLine" id="cb36-14" data-line-number="14">fhpredict<span class="op">:::</span><span class="kw">api_get_generic</span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb36-15" data-line-number="15">fhpredict<span class="op">:::</span><span class="kw">api_get_generic</span>(user_id, spot_id, <span class="dt">generic_id =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb36-16" data-line-number="16"></a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="co"># Delete existing generic inputs -----------------------------------------------</span></a>
<a class="sourceLine" id="cb36-18" data-line-number="18">fhpredict<span class="op">:::</span><span class="kw">api_delete_generic</span>(user_id, spot_id, <span class="dt">generic_id =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb36-19" data-line-number="19"></a>
<a class="sourceLine" id="cb36-20" data-line-number="20"><span class="co"># Delete all generics!</span></a>
<a class="sourceLine" id="cb36-21" data-line-number="21">fhpredict<span class="op">:::</span><span class="kw">api_delete_generic</span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb36-22" data-line-number="22"></a>
<a class="sourceLine" id="cb36-23" data-line-number="23"><span class="co"># Create a new generic input ---------------------------------------------------</span></a>
<a class="sourceLine" id="cb36-24" data-line-number="24">fhpredict<span class="op">:::</span><span class="kw">api_add_generic</span>(user_id, spot_id, <span class="dt">name =</span> <span class="st">"generic_1"</span>)</a>
<a class="sourceLine" id="cb36-25" data-line-number="25">fhpredict<span class="op">:::</span><span class="kw">api_add_generic</span>(user_id, spot_id, <span class="dt">name =</span> <span class="st">"generic_2"</span>)</a>
<a class="sourceLine" id="cb36-26" data-line-number="26">fhpredict<span class="op">:::</span><span class="kw">api_add_generic</span>(user_id, spot_id, <span class="dt">name =</span> <span class="st">"generic_3"</span>)</a>
<a class="sourceLine" id="cb36-27" data-line-number="27"></a>
<a class="sourceLine" id="cb36-28" data-line-number="28"><span class="co"># Add measurements to a specific generic input ---------------------------------</span></a>
<a class="sourceLine" id="cb36-29" data-line-number="29">fhpredict<span class="op">:::</span><span class="kw">api_add_generic_measurements</span>(user_id, spot_id, <span class="dv">16</span>, <span class="dt">data =</span> timeseries)</a>
<a class="sourceLine" id="cb36-30" data-line-number="30"></a>
<a class="sourceLine" id="cb36-31" data-line-number="31"><span class="co"># Read back the generic input. Where are the measurements?</span></a>
<a class="sourceLine" id="cb36-32" data-line-number="32">fhpredict<span class="op">:::</span><span class="kw"><a href="../reference/postgres_get.html">postgres_get</a></span>(</a>
<a class="sourceLine" id="cb36-33" data-line-number="33">  fhpredict<span class="op">:::</span><span class="kw">path_generic_measurements</span>(user_id, spot_id, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb36-34" data-line-number="34">)</a>
<a class="sourceLine" id="cb36-35" data-line-number="35"></a>
<a class="sourceLine" id="cb36-36" data-line-number="36">fhpredict<span class="op">:::</span><span class="kw">api_get_generic</span>(user_id, spot_id, <span class="dt">generic_id =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb36-37" data-line-number="37"></a>
<a class="sourceLine" id="cb36-38" data-line-number="38"><span class="co"># Get irradiance measurements --------------------------------------------------</span></a>
<a class="sourceLine" id="cb36-39" data-line-number="39">fhpredict<span class="op">:::</span><span class="kw">api_get_irradiances</span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb36-40" data-line-number="40"></a>
<a class="sourceLine" id="cb36-41" data-line-number="41"><span class="co"># Delete all irradiance measurements -------------------------------------------</span></a>
<a class="sourceLine" id="cb36-42" data-line-number="42">fhpredict<span class="op">:::</span><span class="kw">api_delete_irradiances</span>(user_id, spot_id)</a>
<a class="sourceLine" id="cb36-43" data-line-number="43"></a>
<a class="sourceLine" id="cb36-44" data-line-number="44"><span class="co"># Add irradiance measurements --------------------------------------------------</span></a>
<a class="sourceLine" id="cb36-45" data-line-number="45">fhpredict<span class="op">:::</span><span class="kw">api_add_irradiances</span>(user_id, spot_id, <span class="dt">data =</span> timeseries)</a></code></pre></div>
</div>
<div id="get-overview-on-available-data" class="section level2">
<h2 class="hasAnchor">
<a href="#get-overview-on-available-data" class="anchor"></a>Get overview on available data</h2>
<p>The following function reads all timeseries that are stored for a bathing spot and returns the range of dates covered as well as the number <code>n</code>of data points.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">user_id &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">spots &lt;-<span class="st"> </span>fhpredict<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/fhpredict/man/api_get_bathingspot.html">api_get_bathingspot</a></span>(user_id)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">spot_ids &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(spots<span class="op">$</span>id, spots<span class="op">$</span>name)</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">summaries &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(spot_ids, fhpredict<span class="op">::</span>get_data_summary, <span class="dt">user_id =</span> user_id)</a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">#&gt; Reading rain data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9"><span class="co">#&gt; Reading rain data from database ... ok. (0.44s) </span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="co">#&gt; Reading rain data from database ... ok. (0.85s) </span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="co">#&gt; Reading discharge data from database ... ok. (0.33s) </span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="co">#&gt; Reading rain data from database ... ok. (0.25s) </span></a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-20" data-line-number="20"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-21" data-line-number="21"><span class="co">#&gt; Reading rain data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-23" data-line-number="23"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.32s) </span></a>
<a class="sourceLine" id="cb37-24" data-line-number="24"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-25" data-line-number="25"><span class="co">#&gt; Reading rain data from database ... ok. (0.42s) </span></a>
<a class="sourceLine" id="cb37-26" data-line-number="26"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-27" data-line-number="27"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-28" data-line-number="28"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.25s) </span></a>
<a class="sourceLine" id="cb37-29" data-line-number="29"><span class="co">#&gt; Reading rain data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-30" data-line-number="30"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-31" data-line-number="31"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-32" data-line-number="32"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-33" data-line-number="33"><span class="co">#&gt; Reading rain data from database ... ok. (0.38s) </span></a>
<a class="sourceLine" id="cb37-34" data-line-number="34"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-35" data-line-number="35"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-36" data-line-number="36"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.25s) </span></a>
<a class="sourceLine" id="cb37-37" data-line-number="37"><span class="co">#&gt; Reading rain data from database ... ok. (0.39s) </span></a>
<a class="sourceLine" id="cb37-38" data-line-number="38"><span class="co">#&gt; Reading discharge data from database ... ok. (0.25s) </span></a>
<a class="sourceLine" id="cb37-39" data-line-number="39"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-40" data-line-number="40"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-41" data-line-number="41"><span class="co">#&gt; Reading rain data from database ... ok. (0.31s) </span></a>
<a class="sourceLine" id="cb37-42" data-line-number="42"><span class="co">#&gt; Reading discharge data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-43" data-line-number="43"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-44" data-line-number="44"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.25s) </span></a>
<a class="sourceLine" id="cb37-45" data-line-number="45"><span class="co">#&gt; Reading rain data from database ... ok. (0.45s) </span></a>
<a class="sourceLine" id="cb37-46" data-line-number="46"><span class="co">#&gt; Reading discharge data from database ... ok. (0.31s) </span></a>
<a class="sourceLine" id="cb37-47" data-line-number="47"><span class="co">#&gt; Reading irradiances data from database ... ok. (0.24s) </span></a>
<a class="sourceLine" id="cb37-48" data-line-number="48"><span class="co">#&gt; Reading timeseries data from database ... ok. (0.24s)</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#install-the-package">Install the package</a></li>
      <li><a href="#users">Users</a></li>
      <li><a href="#bathing-spots">Bathing Spots</a></li>
      <li><a href="#measurements">Measurements</a></li>
      <li><a href="#models">Models</a></li>
      <li><a href="#purification-plants">Purification Plants</a></li>
      <li><a href="#rains">Rains</a></li>
      <li><a href="#rains-details">Rains: Details</a></li>
      <li><a href="#discharge-data">Discharge data</a></li>
      <li><a href="#irradiances-and-generic-inputs">Irradiances and Generic Inputs</a></li>
      <li><a href="#get-overview-on-available-data">Get overview on available data</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.researchgate.net/profile/Wolfgang_Seis">Wolfgang Seis</a>, <a href="https://github.com/hsonne">Hauke Sonnenberg</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'eab9471a295adad1867e1368f918ef6d',
    indexName: 'kwb_fhpredict',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
